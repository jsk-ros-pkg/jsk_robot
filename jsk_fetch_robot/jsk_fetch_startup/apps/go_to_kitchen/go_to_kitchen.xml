<launch>
  <node name="go_to_kitchen" pkg="roseus" type="roseus" required="true" output="screen"
        args="$(find jsk_fetch_startup)/euslisp/go-to-kitchen.l" />

  <!-- launch rviz with throttle -->
  <include file="$(find jsk_fetch_startup)/launch/rviz_record.launch" />

  <node name="go_to_kitchen_object_detector_score_thresh" pkg="dynamic_reconfigure" type="dynparam"
        args="set_from_parameters edgetpu_object_detector">
    <param name="score_thresh" type="double" value="0.60" /> <!-- default: 0.6 -->
  </node>

  <!-- Image topic hz converter for better synchronization betweeen audio and video-->
  <node name="head_camera_image_hz_converter"
        pkg="jsk_topic_tools"
        type="topic_hz_converter.py">
    <remap from="~input" to="/head_camera/rgb/image_rect_color" />
    <remap from="~output" to="/head_camera/rgb/image_rect_color/hz_converted" />
    <rosparam>
      desired_topic_hz: 30
    </rosparam>
  </node>

  <node name="object_detect_image_hz_converter"
        pkg="jsk_topic_tools"
        type="topic_hz_converter.py">
    <remap from="~input" to="/edgetpu_object_detector/output/image" />
    <remap from="~output" to="/edgetpu_object_detector/output/image/hz_converted" />
    <rosparam>
      desired_topic_hz: 30
    </rosparam>
  </node>

  <!-- Use m5stack_ros -->
  <!-- See https://github.com/jsk-ros-pkg/jsk_3rdparty/pull/289 -->
  <node name="rosserial_m5stack" pkg="rosserial_python" type="serial_node.py">
    <rosparam>
      port: /dev/rfcomm0 <!-- See /var/lib/robot/rfcomm_devices.yaml -->
      baud: 115200
    </rosparam>
  </node>

  <!-- Trash can occupancy detector -->
  <include file="$(find jsk_fetch_startup)/launch/trashbin_occupancy_detector.launch" />

  <node name="$(anon rviz)" pkg="rviz" type="rviz"
        args="-d $(find jsk_fetch_startup)/config/jsk_startup_record.rviz">
    <env name="DISPLAY" value=":0" />
    <env name="HOME" value="/home/fetch" />
  </node>

</launch>
